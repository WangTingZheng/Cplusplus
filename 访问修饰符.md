# 访问修饰符

## public和private

和函数一样，在类中，我们希望向外暴露一些API接口供用户调用和读取，而堆某些底层实现细节进行屏蔽，这些细节可能不需要调用者操心，因为这会使得调用者分心，或者这些函数和接口可以调用一些敏感的资源，进行一些危险的操作，必须有本类来调用，本类来负责，又或者我们不希望我们本类的代码底层的实现的变动影响到其它类。

对于想要向外暴露的函数API或数据，我们可以用public来修饰，想要对外隐藏，自己负责的，可以使用private来修饰。

## friend class

之前我们只讨论了类与其它类之间的关系，实际上类的关系更加复杂，很多时候，我既不想把接口公开，又不想私有，我想只对一部分类公开，对一部分类私有，那么我们就可以定义想要对其公开的类为friend class，那么这些类就可以去访问到本类的private的资源了。

一个典型的应用就是LevelDB里的InternalGet，这个函数负责实现SSTable的点查功能，但是如果每次点查都读取一个一整个SSTable，点查完就释放，就有点浪费，所以其它类不能直接调用这个InternalGet，所以这个函数是私有的，但是LevelDB把SSTable放在TableCache里，TableCache缓存了Table，可以重复利用Table，它是可以需要调用InternalGet的，所以我们必须把TableCache类定义成Table的友元。

## protected

类之间还存在继承关系，很多时候，尽管我们不希望一些函数API或变量被其它类访问，但是我们希望一些东西被自己的派生类访问，所以C++提供了proteccted修饰符，被它修饰的函数API或者变量可以被自己的派生类调用。

# public/private/protected继承

## 使用方法

我们知道，一个派生类继承一个基类时，就会把基类的变量也继承过来，C++在继承的时候，给予了程序员修改变量访问权限的能力，比如说：

```C++
class Base{
    public:
        int x;
    protected:
        int y;
    private:
        int z;
};

```
我们用public继承的时候，x，y，z是都在PublicDerived里的，public的意思是，变量的最高修饰符是public，所以所有的变量都保持不变：
```C++
class PublicDerived: public Base{
    /*
        int x; public
        int y; projected
        int z; private
    */
};
```
对于protected继承，意思是，继承而来的变量最高的访问修饰符是protected，也就是说，x现在从public变成了protected的了：

```C++
class ProtectedDerived: protected Base{
    /*
        int x; protected
        int y; protected
        int z; private
    */
};
```
对于private继承，意思是，所有的访问修饰符最高的就是private的：
```C++
class PrivateDerived: private Base{
    /*
        int x; private
        int y; private
        int z; private
    */
};
```

## 注意点
要注意的是，这些访问修饰符，是控制的访问权限，而不是可见性，也就是说，一个变量是private的，编译器仍然可以见到它，但是不能访问它。比如说：

```C++
int a;
class X{
    int a;
}

class XX : public X{
    void f(){
        a = 1;
    }
}
```

其中，X中的a是private的，XX继承X时，访问a时会优先访问X里继承而来的a，但是它发现继承而来的a是private的，不能访问，所以会报错无法访问a，说明编译器肯定是看到了X里的a，只是不能访问，如果编译器因为继承X的a是私有的就看不见a，那么它应该访问的是全局变量中的a，就不会报错了。


# 总结

要维护类与类之间的关系，所以有了public/private，要对某些类精确地进行访问权限地控制，所以有了friend class，维护基类与派生类之间的关系，我们有了protected。

我们还介绍了C++通过public/protected/priavte继承来改变派生类中的变量的属性。